<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciar Pessoas - Lista de Presença</title>
    
    <!-- Script do Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        /* Uma fonte mais moderna para o projeto */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Animação de fade-in para a lista e modal */
        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }
        
        .modal-scale-in {
            animation: scaleIn 0.3s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes scaleIn {
            from { opacity: 0; transform: scale(0.95); }
            to { opacity: 1; transform: scale(1); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen">

    <main class="max-w-4xl mx-auto p-4 sm:p-8">
        
        <!-- CABEÇALHO -->
        <header class="mb-10">
            <a href="index.html" class="text-cyan-400 hover:text-cyan-300 transition-colors mb-4 inline-block">&larr; Voltar ao Painel</a>
            <h1 class="text-4xl font-bold text-white">Gerenciar Pessoas</h1>
            <p class="text-lg text-gray-400 mt-1">Adicione, edite ou remova pessoas da sua lista mestra.</p>
        </header>

        <!-- BARRA DE AÇÕES: Pesquisa e Adicionar -->
        <div class="flex flex-col sm:flex-row items-center justify-between gap-4 mb-8">
            <!-- Caixa de Pesquisa -->
            <div class="relative w-full sm:w-auto">
                <input 
                    type="text" 
                    id="search-input"
                    placeholder="Pesquisar por nome..."
                    class="w-full sm:w-64 bg-gray-800 border border-gray-700 rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition-all"
                >
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <svg class="h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z" clip-rule="evenodd" /></svg>
                </div>
            </div>
            <!-- Botão Adicionar Pessoa -->
            <button id="add-person-btn" class="w-full sm:w-auto flex items-center justify-center gap-2 bg-cyan-600 hover:bg-cyan-500 text-white font-bold py-2 px-4 rounded-lg transition-all duration-300 transform hover:scale-105">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"><path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" /></svg>
                Adicionar Pessoa
            </button>
        </div>

        <!-- LISTA DE PESSOAS -->
        <section id="people-list-container" class="space-y-3">
            <!-- Os itens da lista serão inseridos aqui pelo JavaScript -->
        </section>

    </main>

    <!-- MODAL: Adicionar/Editar Pessoa -->
    <div id="person-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 w-full max-w-md rounded-xl border border-gray-700 shadow-xl p-6 modal-scale-in">
            <h2 id="modal-title" class="text-2xl font-bold mb-4">Adicionar Nova Pessoa</h2>
            <form id="person-form">
                <div>
                    <label for="person-name" class="block text-sm font-medium text-gray-300 mb-1">Nome Completo</label>
                    <input type="text" id="person-name" name="person-name" required class="w-full bg-gray-700 border border-gray-600 rounded-lg py-2 px-3 focus:outline-none focus:ring-2 focus:ring-cyan-500">
                </div>
                <div class="mt-6 flex justify-end gap-3">
                    <button type="button" id="cancel-btn" class="py-2 px-4 bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors">Cancelar</button>
                    <button type="submit" id="save-btn" class="py-2 px-4 bg-cyan-600 hover:bg-cyan-500 rounded-lg font-semibold transition-colors">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- MODAL DE CONFIRMAÇÃO DE EXCLUSÃO -->
    <div id="delete-confirm-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 hidden">
        <div class="bg-gray-800 w-full max-w-md rounded-xl border border-gray-700 shadow-xl p-6 modal-scale-in">
            <h2 class="text-2xl font-bold mb-2">Confirmar Exclusão</h2>
            <p id="delete-confirm-text" class="text-gray-300 mb-6">Tem certeza que deseja remover esta pessoa?</p>
            <div class="flex justify-end gap-3">
                <button type="button" id="cancel-delete-btn" class="py-2 px-4 bg-gray-600 hover:bg-gray-500 rounded-lg transition-colors">Cancelar</button>
                <button type="button" id="confirm-delete-btn" class="py-2 px-4 bg-red-600 hover:bg-red-500 rounded-lg font-semibold transition-colors">Excluir</button>
            </div>
        </div>
    </div>


    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ELEMENTOS DO DOM ---
            const peopleListContainer = document.getElementById('people-list-container');
            const searchInput = document.getElementById('search-input');
            
            // Modal de Adicionar/Editar
            const personModal = document.getElementById('person-modal');
            const modalTitle = document.getElementById('modal-title');
            const personForm = document.getElementById('person-form');
            const personNameInput = document.getElementById('person-name');
            const addPersonBtn = document.getElementById('add-person-btn');
            const cancelBtn = document.getElementById('cancel-btn');
            const saveBtn = document.getElementById('save-btn');

            // Modal de Exclusão
            const deleteConfirmModal = document.getElementById('delete-confirm-modal');
            const deleteConfirmText = document.getElementById('delete-confirm-text');
            const cancelDeleteBtn = document.getElementById('cancel-delete-btn');
            const confirmDeleteBtn = document.getElementById('confirm-delete-btn');

            // --- ESTADO DA APLICAÇÃO ---
            let personToEditId = null;
            let personToDeleteId = null;

            // --- FUNÇÕES DE DADOS (localStorage) ---
            const getPeople = () => JSON.parse(localStorage.getItem('attendance_people')) || [];
            const savePeople = (people) => localStorage.setItem('attendance_people', JSON.stringify(people));

            // --- RENDERIZAÇÃO ---
            function renderPeople(filter = '') {
                peopleListContainer.innerHTML = '';
                const people = getPeople();
                
                const filteredPeople = people
                    .filter(p => p.name.toLowerCase().includes(filter.toLowerCase()))
                    .sort((a, b) => a.name.localeCompare(b.name)); // <-- ORDENAÇÃO ALFABÉTICA

                if (filteredPeople.length === 0 && filter === '') {
                    peopleListContainer.innerHTML = `<div class="bg-gray-800/50 text-center p-8 rounded-lg">
                                                        <h3 class="text-xl font-semibold text-gray-400">Nenhuma pessoa encontrada.</h3>
                                                        <p class="text-gray-500 mt-2">Adicione pessoas para começar a montar suas listas.</p>
                                                     </div>`;
                    return;
                }
                
                if (filteredPeople.length === 0 && filter !== '') {
                    peopleListContainer.innerHTML = `<div class="bg-gray-800/50 text-center p-8 rounded-lg"><p class="text-gray-400">Nenhuma pessoa encontrada com o nome "${filter}".</p></div>`;
                    return;
                }

                filteredPeople.forEach(person => {
                    const personElement = document.createElement('div');
                    personElement.className = 'bg-gray-800/80 p-4 rounded-lg flex items-center justify-between transition-all duration-300 hover:bg-gray-700/60 fade-in';
                    personElement.innerHTML = `
                        <p class="font-medium text-lg">${person.name}</p>
                        <div class="flex items-center space-x-3">
                            <button class="edit-btn p-2 rounded-md text-blue-400 hover:bg-blue-600/20 transition-colors" data-id="${person.id}" aria-label="Editar nome">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none" viewBox="0 0 20 20" fill="currentColor"><path d="M17.414 2.586a2 2 0 00-2.828 0L7 10.172V13h2.828l7.586-7.586a2 2 0 000-2.828z" /><path fill-rule="evenodd" d="M2 6a2 2 0 012-2h4a1 1 0 010 2H4v10h10v-4a1 1 0 112 0v4a2 2 0 01-2 2H4a2 2 0 01-2-2V6z" clip-rule="evenodd" /></svg>
                            </button>
                            <button class="delete-btn p-2 rounded-md text-red-400 hover:bg-red-600/20 transition-colors" data-id="${person.id}" aria-label="Excluir pessoa">
                                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 pointer-events-none" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
                            </button>
                        </div>
                    `;
                    peopleListContainer.appendChild(personElement);
                });
            }

            // --- LÓGICA DOS MODAIS ---
            function openModal(mode = 'add', id = null) {
                personToEditId = null;
                if (mode === 'edit' && id) {
                    const people = getPeople();
                    const person = people.find(p => p.id === id);
                    if (person) {
                        personToEditId = id;
                        modalTitle.textContent = 'Editar Nome';
                        personNameInput.value = person.name;
                        saveBtn.textContent = 'Salvar Alterações';
                    }
                } else {
                    modalTitle.textContent = 'Adicionar Nova Pessoa';
                    personNameInput.value = '';
                    saveBtn.textContent = 'Salvar';
                }
                personModal.classList.remove('hidden');
                personNameInput.focus();
            }

            const closeModal = () => personModal.classList.add('hidden');
            
            function openDeleteModal(id) {
                const people = getPeople();
                const person = people.find(p => p.id === id);
                if (person) {
                    personToDeleteId = id;
                    deleteConfirmText.innerHTML = `Tem certeza que deseja excluir <strong>${person.name}</strong>? Esta ação não pode ser desfeita.`;
                    deleteConfirmModal.classList.remove('hidden');
                }
            }

            const closeDeleteModal = () => deleteConfirmModal.classList.add('hidden');

            // --- EVENT LISTENERS ---
            addPersonBtn.addEventListener('click', () => openModal('add'));
            cancelBtn.addEventListener('click', closeModal);
            personModal.addEventListener('click', (e) => e.target === personModal && closeModal());

            personForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const name = personNameInput.value.trim();
                if (!name) return;

                let people = getPeople();
                if (personToEditId) { // Modo Edição
                    const person = people.find(p => p.id === personToEditId);
                    if (person) person.name = name;
                } else { // Modo Adição
                    people.push({ id: crypto.randomUUID(), name: name });
                }
                savePeople(people);
                renderPeople(searchInput.value);
                closeModal();
            });

            peopleListContainer.addEventListener('click', (e) => {
                const editBtn = e.target.closest('.edit-btn');
                const deleteBtn = e.target.closest('.delete-btn');

                if (editBtn) openModal('edit', editBtn.dataset.id);
                if (deleteBtn) openDeleteModal(deleteBtn.dataset.id);
            });

            searchInput.addEventListener('input', () => renderPeople(searchInput.value));

            // Listeners do modal de exclusão
            cancelDeleteBtn.addEventListener('click', closeDeleteModal);
            confirmDeleteBtn.addEventListener('click', () => {
                if (personToDeleteId) {
                    let people = getPeople();
                    people = people.filter(p => p.id !== personToDeleteId);
                    savePeople(people);
                    renderPeople(searchInput.value);
                    closeDeleteModal();
                }
            });

            // --- INICIALIZAÇÃO ---
            renderPeople();
        });
    </script>
</body>
</html>
